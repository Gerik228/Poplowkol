Отлично!
Сейчас я напишу тебе полную и пошаговую инструкцию, как создать свой Region Plugin в Oracle APEX для вывода CLOB с готовой HTML-разметкой.
Будет все: от создания файла плагина до загрузки в APEX.


---

Полная инструкция: Плагин "Region" для вставки HTML из CLOB


---

1. Создание SQL скрипта для установки плагина

Создаём файл, например, dynamic_html_region_plugin.sql
Вот содержимое:

prompt Creating Plugin: Dynamic HTML Region

begin
    apex_plugin.create_plugin (
        p_id                => null,
        p_plugin_type       => 'REGION TYPE',
        p_name              => 'DYNAMIC_HTML_REGION',
        p_display_name      => 'Dynamic HTML Region',
        p_supported_ui_types => 'DESKTOP',
        p_plsql_code        => q'[
            function render (
                p_region in apex_plugin.t_region,
                p_plugin in apex_plugin.t_plugin,
                p_is_printer_friendly in boolean
            ) return apex_plugin.t_region_render_result
            is
                l_content clob;
            begin
                -- Получаем CLOB из таблицы
                select your_clob_column
                into l_content
                from your_table
                where id = :P1_ID; -- можно привязать к параметру плагина

                -- Печатаем HTML
                apex_plugin_util.print_clob_output(
                    p_clob => 
                        '<div class="wrapper">
                            <h1>Моя страница</h1>
                            <div id="dynamic-content">' || l_content || '</div>
                        </div>'
                );

                return null;
            end render;
        ]',
        p_render_function   => 'render',
        p_api_version       => 2,
        p_version_identifier=> '1.0',
        p_substitute_attributes => 'Y',
        p_subscribe_plugin_settings => 'N'
    );
    commit;
end;
/


---

2. Что делает этот код?

Создаёт новый плагин типа Region с именем Dynamic HTML Region.

Подключает PL/SQL функцию render, которая:

Достаёт CLOB из таблицы по :P1_ID.

Вставляет CLOB в готовую HTML разметку.


Выводит всё сразу на страницу.



---

3. Как установить этот плагин в APEX

1. Открой APEX -> Workspace.


2. Зайди в SQL Workshop -> SQL Commands.


3. Выполни скрипт dynamic_html_region_plugin.sql.



Плагин будет зарегистрирован.


---

4. Как использовать плагин на странице

1. Иди в своё приложение.


2. Нажми Create Region -> выбери Plug-ins.


3. Найди Dynamic HTML Region.


4. Создай регион на нужной странице.


5. Обязательно укажи значение элемента P1_ID (или поменяй в PL/SQL коде под свои нужды).




---

5. Что важно учесть

Если хочешь использовать динамические параметры, лучше сделать атрибуты плагина через apex_plugin_util.get_attribute.

Если CLOB может быть очень большим — настрой параметр DBMS_OUTPUT на высокое значение.

Если есть вложенные скрипты (<script> внутри CLOB) — проверь настройки XSS в приложении.



---

Бонус: Версия с параметром для ID

Если хочешь сделать плагин более универсальным (чтобы ID был не привязан к :P1_ID, а передавался через атрибут плагина):

Вместо кода:

where id = :P1_ID;

пиши:

where id = apex_plugin_util.get_attribute(p_region.attribute_01);

И добавь в плагин описание атрибута:

Attribute 1 Name: Record ID

Type: Text

Required: Yes


Тогда ты при создании региона будешь указывать ID записи прямо в свойствах.


---

ИТОГО

Ты получаешь:


---

Хочешь, я ещё сразу кину тебе готовый ZIP-пакет с этим плагином (plugin.sql + manifest.json) для быстрой загрузки через "Create -> Plug-in -> Import" в APEX?

Скажи — тогда я всё упакую!
Хочешь?

