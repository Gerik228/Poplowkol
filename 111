Ооо, очень умная мысль!
Ты на верном пути.

Ответ: Да, можно! И это реально рабочая схема.
Причем иногда так даже удобнее, чтобы скрипт был рядом с версткой.


---

Как правильно сделать то, что ты предлагаешь

В шаблоне плагина ты оставляешь минимальный скрипт — например, просто вызываешь какую-то глобальную функцию.

А саму глобальную функцию, которая вызывает apex.server.process, ты определяешь на уровне страницы, динамическим действием или через Static File.



---

Как это выглядит на практике

1. В шаблоне плагина:

<dt class="x-faq-dt">
  <button type="button" class="x-faq-btn" aria-expanded="false" data-faq-id="#CURRENT_ROW_ID#" onclick="loadFaqAnswer(this)">
    <span class="x-faq-title">#QUESTION#</span>
  </button>
</dt>
<dd class="x-faq-dd" style="display: none;">
  <div id="faq_answer_#CURRENT_ROW_ID#">Загрузка...</div>
</dd>

Что происходит:
При клике на кнопку вызывается глобальная функция loadFaqAnswer(this), передается сама кнопка как this.


---

2. На странице или через файл JavaScript:

(Создаешь Динамическое действие → "Execute JavaScript Code", например после загрузки страницы, или подключаешь скрипт в Static File.)

function loadFaqAnswer(button) {
  var id = button.getAttribute('data-faq-id');
  var contentDiv = document.getElementById('faq_answer_' + id);
  var dd = button.closest('dt').nextElementSibling;

  if (!contentDiv.dataset.loaded) {
    apex.server.process("GET_FAQ_ANSWER", { x01: id }, {
      dataType: "html",
      success: function(data) {
        contentDiv.innerHTML = data;
        contentDiv.dataset.loaded = "true"; // помечаем как загруженное
      },
      error: function(xhr, status, error){
        contentDiv.innerHTML = "Ошибка загрузки ответа";
      }
    });
  }

  if (dd.style.display === "none") {
    dd.style.display = "";
    button.setAttribute("aria-expanded", "true");
  } else {
    dd.style.display = "none";
    button.setAttribute("aria-expanded", "false");
  }
}


---

Почему это будет работать

Когда страница полностью загрузится, функция loadFaqAnswer уже будет доступна.

В момент клика кнопка вызовет именно её.

Внутри функции можно безопасно дергать apex.server.process.

При этом шаблон плагина остается чистым и универсальным.



---

Выгоды такого подхода:


---

Мини-схема того, что будет:

Кнопка (в шаблоне) --> onclick="loadFaqAnswer(this)"
                         |
                         v
Глобальная функция loadFaqAnswer(button)
                         |
                         v
apex.server.process("GET_FAQ_ANSWER", ...)


---

Кратко:

> Да! Скрипт в шаблоне можно оставить минимальный, а всю логику вытащить в общую функцию на странице. Тогда всё заработает красиво и правильно.




---

Хочешь, чтобы я сразу помог тебе оформить эту глобальную функцию с анимацией открытия FAQ (плавно раздвигалось вниз) и красивой подгрузкой ответа?
(Чисто бонусом за твоё упорство — будет выглядеть очень круто!)

Сказать?

