Отлично! В APEX 23.1 ты не сможешь напрямую указать "PL/SQL Function Body returning CLOB" в типе Static Content региона, как это можно сделать, например, в Dynamic Content. Но мы всё равно можем реализовать новостную ленту с полной динамикой.

Вот рабочий способ для APEX 23.1, с поддержкой BLOB-изображений, редактируемым HTML и CSS, и полной динамикой:


---

Пошаговая инструкция

1. Создай регион типа Dynamic Content

В Page Designer:

Добавь Region.

Тип: Dynamic Content.

Назови, например, News Feed.




---

2. В Source вставь такой PL/SQL код:

DECLARE
  l_clob    CLOB;
  l_img_b64 CLOB;
BEGIN
  FOR rec IN (
    SELECT title, content, created_at, image, mime_type
    FROM news
    ORDER BY created_at DESC
  ) LOOP
    -- Преобразование изображения в base64
    IF rec.image IS NOT NULL THEN
      l_img_b64 := apex_web_service.blob2clobbase64(rec.image);
    ELSE
      l_img_b64 := NULL;
    END IF;

    -- Формируем HTML
    l_clob := l_clob || '<div class="news-item">';
    IF l_img_b64 IS NOT NULL THEN
      l_clob := l_clob || '<img src="data:' || rec.mime_type || ';base64,' || l_img_b64 || '" class="news-img">';
    END IF;
    l_clob := l_clob || '<h3>' || rec.title || '</h3>';
    l_clob := l_clob || '<p>' || rec.content || '</p>';
    l_clob := l_clob || '<small>' || TO_CHAR(rec.created_at, 'DD.MM.YYYY') || '</small>';
    l_clob := l_clob || '</div>';
  END LOOP;

  -- Выводим HTML
  HTP.P('<style>
    .news-item {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 6px;
      background-color: #f9f9f9;
    }
    .news-item h3 { margin-top: 0; }
    .news-img {
      max-width: 100%;
      height: auto;
      margin-bottom: 10px;
      border-radius: 4px;
    }
  </style>');
  HTP.P(l_clob);
END;


---

3. Убедись, что у тебя есть таблица news

Минимальная структура:

CREATE TABLE news (
  id          NUMBER GENERATED BY DEFAULT AS IDENTITY,
  title       VARCHAR2(200),
  content     CLOB,
  created_at  DATE DEFAULT SYSDATE,
  image       BLOB,
  mime_type   VARCHAR2(100)
);


---

4. Настрой права и разреши BLOB-обработку

Убедись, что у тебя включён apex_web_service и он работает в сессии.

Не загружай огромные изображения — оптимизируй их заранее.



---

Готово!

Ты получил новостную ленту, которая:

Динамически обновляется из таблицы;

Показывает изображения;

Использует кастомный HTML и стили;

Подходит под ограничения APEX 23.1.


Хочешь — адаптирую код под конкретное имя таблицы или добавлю пагинацию.

