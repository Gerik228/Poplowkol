—Ç–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

# –†–∞–∑–≤–µ—Ä–Ω—É—Ç–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü –≤ Oracle APEX 23.1

## –í–≤–µ–¥–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü –º–µ–∂–¥—É —É–¥–∞–ª–µ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ä–µ–¥–µ Oracle APEX 23.1 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Oracle Database 19c —á–µ—Ä–µ–∑ database link (dblink)[1][2]. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

1. **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
   - `validate_sync_environment` - –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - `sync_single_table_advanced` - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - `create_smart_sync_job` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π

2. **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
   - –¢–∞–±–ª–∏—Ü–∞ `sync_log` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `v_sync_dashboard` –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
   - –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ `manage_sync_jobs` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è–º–∏

3. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DBMS_SCHEDULER –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏[3][4]
   - –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –°–∏—Å—Ç–µ–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –£–¥–∞–ª–µ–Ω–Ω–∞—è –ë–î   ‚îÇ    ‚îÇ   Database Link  ‚îÇ    ‚îÇ   –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î  ‚îÇ
‚îÇ  (–ò—Å—Ç–æ—á–Ω–∏–∫)     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚î§                  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  (–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ)   ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ
         ‚îÇ              ‚îÇ  APEX 23.1      ‚îÇ              ‚îÇ
         ‚îÇ              ‚îÇ  SQL Workshop   ‚îÇ              ‚îÇ
         ‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ
         ‚îÇ                                               ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ –¢–∞–±–ª–∏—Ü—ã ‚îÇ                                    ‚îÇ –õ–æ–∫–∞–ª—å–Ω—ã–µ ‚îÇ
    ‚îÇ –¥–∞–Ω–Ω—ã—Ö  ‚îÇ                                    ‚îÇ –∫–æ–ø–∏–∏     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Oracle APEX**: –í–µ—Ä—Å–∏—è 23.1 –∏–ª–∏ –≤—ã—à–µ[5][6]
- **Oracle Database**: –í–µ—Ä—Å–∏—è 19c –∏–ª–∏ –≤—ã—à–µ[5]
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: 
  - `CREATE JOB` –¥–ª—è DBMS_SCHEDULER[7]
  - `CREATE TABLE`, `DROP TABLE`
  - `CREATE PROCEDURE`, `CREATE VIEW`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ database link

Database link –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω[1][8]:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö dblink
SELECT db_link, username, host FROM user_db_links;

-- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
SELECT * FROM dual@YOUR_DBLINK;
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ sync_log

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏[9]:

```sql
CREATE TABLE sync_log (
    id NUMBER GENERATED ALWAYS AS IDENTITY,
    table_name VARCHAR2(128) NOT NULL,
    sync_date DATE NOT NULL,
    sync_type VARCHAR2(20) NOT NULL DEFAULT 'FULL',
    status VARCHAR2(15) NOT NULL,
    source_row_count NUMBER DEFAULT 0,
    target_row_count NUMBER DEFAULT 0,
    duration_seconds NUMBER,
    validation_result VARCHAR2(4000),
    error_msg VARCHAR2(4000),
    created_at TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT pk_sync_log PRIMARY KEY (id),
    CONSTRAINT chk_sync_status CHECK (status IN ('SUCCESS', 'ERROR', 'WARNING', 'EMPTY_SOURCE')),
    CONSTRAINT chk_sync_type CHECK (sync_type IN ('FULL', 'INCREMENTAL'))
);
```

### –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```sql
CREATE OR REPLACE VIEW v_sync_dashboard AS
SELECT 
    table_name,
    sync_type,
    status,
    sync_date,
    source_row_count,
    target_row_count,
    ROUND(duration_seconds, 2) as duration_sec,
    CASE 
        WHEN status = 'SUCCESS' AND sync_date > SYSDATE - 1 THEN 'HEALTHY'
        WHEN status = 'EMPTY_SOURCE' THEN 'EMPTY_SOURCE'
        WHEN status = 'WARNING' THEN 'WARNING'
        WHEN sync_date < SYSDATE - 2 THEN 'OUTDATED'
        ELSE 'ERROR'
    END as health_status,
    SUBSTR(validation_result, 1, 100) as validation_short,
    SUBSTR(error_msg, 1, 200) as error_short,
    created_at
FROM (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY table_name ORDER BY sync_date DESC) as rn
    FROM sync_log
) WHERE rn = 1
ORDER BY 
    CASE health_status 
        WHEN 'ERROR' THEN 1 
        WHEN 'WARNING' THEN 2 
        WHEN 'OUTDATED' THEN 3 
        WHEN 'EMPTY_SOURCE' THEN 4 
        ELSE 5 
    END,
    sync_date DESC;
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

### –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ `validate_sync_environment` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```sql
CREATE OR REPLACE PROCEDURE validate_sync_environment(
    p_table_name VARCHAR2,
    p_dblink_name VARCHAR2,
    p_validation_result OUT VARCHAR2,
    p_source_count OUT NUMBER,
    p_is_valid OUT BOOLEAN
) IS
    v_count NUMBER;
    v_dblink_valid BOOLEAN := FALSE;
    v_table_exists NUMBER := 0;
    v_full_table_name VARCHAR2(256);
    v_source_schema VARCHAR2(128);
    v_base_table_name VARCHAR2(128);
BEGIN
    p_is_valid := FALSE;
    p_validation_result := '';
    p_source_count := 0;
    
    -- –ü–∞—Ä—Å–∏–Ω–≥ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã
    v_full_table_name := UPPER(TRIM(p_table_name));
    IF INSTR(v_full_table_name, '.') > 0 THEN
        v_source_schema := REGEXP_SUBSTR(v_full_table_name, '^[^.]+');
        v_base_table_name := REGEXP_SUBSTR(v_full_table_name, '[^.]+$');
    ELSE
        v_source_schema := NULL;
        v_base_table_name := v_full_table_name;
    END IF;
    
    -- –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω–æ–µ –∏–º—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
    IF v_source_schema IS NOT NULL THEN
        v_full_table_name := v_source_schema || '.' || v_base_table_name;
    ELSE
        v_full_table_name := v_base_table_name;
    END IF;
    
    -- 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ dblink
    BEGIN
        EXECUTE IMMEDIATE 'SELECT COUNT(*) FROM dual@' || p_dblink_name INTO v_count;
        v_dblink_valid := TRUE;
        p_validation_result := p_validation_result || 'DBLINK_OK; ';
    EXCEPTION
        WHEN OTHERS THEN
            p_validation_result := p_validation_result || 'DBLINK_ERROR: ' || SQLERRM || '; ';
            RETURN;
    END;
    
    -- 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    BEGIN
        EXECUTE IMMEDIATE 'SELECT COUNT(*) FROM ' || v_full_table_name || '@' || p_dblink_name || ' WHERE ROWNUM = 1' INTO v_table_exists;
        p_validation_result := p_validation_result || 'TABLE_EXISTS; ';
    EXCEPTION
        WHEN OTHERS THEN
            IF SQLCODE = -942 THEN
                p_validation_result := p_validation_result || 'TABLE_NOT_EXISTS; ';
            ELSE
                p_validation_result := p_validation_result || 'TABLE_ACCESS_ERROR: ' || SQLERRM || '; ';
            END IF;
            RETURN;
    END;
    
    -- 3. –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ
    BEGIN
        EXECUTE IMMEDIATE 'SELECT COUNT(*) FROM ' || v_full_table_name || '@' || p_dblink_name INTO p_source_count;
        p_validation_result := p_validation_result || 'SOURCE_COUNT: ' || p_source_count || '; ';
    EXCEPTION
        WHEN OTHERS THEN
            p_validation_result := p_validation_result || 'COUNT_ERROR: ' || SQLERRM || '; ';
            RETURN;
    END;
    
    -- –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
    IF v_dblink_valid AND v_table_exists >= 0 THEN
        p_is_valid := TRUE;
        p_validation_result := p_validation_result || 'VALIDATION_PASSED';
    END IF;
    
EXCEPTION
    WHEN OTHERS THEN
        p_validation_result := 'VALIDATION_FATAL_ERROR: ' || SQLERRM;
        p_is_valid := FALSE;
END validate_sync_environment;
/
```

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ `sync_single_table_advanced` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Ç–∞–±–ª–∏—Ü—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤[10]:

```sql
CREATE OR REPLACE PROCEDURE sync_single_table_advanced(
    p_table_name VARCHAR2,
    p_dblink_name VARCHAR2,
    p_sync_type VARCHAR2 DEFAULT 'FULL',
    p_min_row_threshold NUMBER DEFAULT 0
) IS
    -- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã
    v_full_table_name VARCHAR2(256);
    v_source_schema VARCHAR2(128);
    v_base_table_name VARCHAR2(128);
    v_select_from VARCHAR2(512);
    
    -- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω
    v_local_table_name VARCHAR2(128);
    v_backup_table_name VARCHAR2(128);
    
    -- –°–ª—É–∂–µ–±–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    v_ddl_statement VARCHAR2(4000);
    v_error_msg VARCHAR2(4000);
    v_start_time TIMESTAMP;
    v_end_time TIMESTAMP;
    v_source_count NUMBER := 0;
    v_target_count NUMBER := 0;
    v_validation_result VARCHAR2(4000);
    v_is_environment_valid BOOLEAN;
    v_sync_status VARCHAR2(15) := 'ERROR';
    v_should_proceed BOOLEAN := FALSE;
BEGIN
    v_start_time := SYSTIMESTAMP;
    
    -- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
    v_full_table_name := UPPER(TRIM(p_table_name));
    IF INSTR(v_full_table_name, '.') > 0 THEN
        v_source_schema := REGEXP_SUBSTR(v_full_table_name, '^[^.]+');
        v_base_table_name := REGEXP_SUBSTR(v_full_table_name, '[^.]+$');
    ELSE
        v_source_schema := NULL;
        v_base_table_name := v_full_table_name;
    END IF;
    
    -- –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (–≤—Å–µ–≥–¥–∞ –±–µ–∑ —Å—Ö–µ–º—ã)
    v_local_table_name := 'LOCAL_' || v_base_table_name || '_BACKUP';
    v_backup_table_name := 'LOCAL_' || v_base_table_name || '_OLD';
    
    -- –§–æ—Ä–º–∏—Ä—É–µ–º FROM-—á–∞—Å—Ç—å –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ dblink
    IF v_source_schema IS NOT NULL THEN
        v_select_from := v_source_schema || '.' || v_base_table_name || '@' || p_dblink_name;
    ELSE
        v_select_from := v_base_table_name || '@' || p_dblink_name;
    END IF;
    
    -- –í—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    validate_sync_environment(
        p_table_name => p_table_name,
        p_dblink_name => p_dblink_name,
        p_validation_result => v_validation_result,
        p_source_count => v_source_count,
        p_is_valid => v_is_environment_valid
    );
    
    -- –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    IF NOT v_is_environment_valid THEN
        v_sync_status := 'ERROR';
        v_error_msg := 'Environment validation failed: ' || v_validation_result;
    ELSIF v_source_count < p_min_row_threshold THEN
        v_sync_status := 'EMPTY_SOURCE';
        v_error_msg := 'Source table has insufficient data (' || v_source_count || ' rows, threshold: ' || p_min_row_threshold || ')';
    ELSE
        v_should_proceed := TRUE;
    END IF;
    
    -- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
    IF v_should_proceed THEN
        BEGIN
            -- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã
            BEGIN
                EXECUTE IMMEDIATE 'ALTER TABLE ' || v_local_table_name || 
                                 ' RENAME TO ' || v_backup_table_name;
            EXCEPTION
                WHEN OTHERS THEN 
                    DBMS_OUTPUT.PUT_LINE('–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è —Ç–∞–±–ª–∏—Ü—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é');
            END;
            
            -- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
            v_ddl_statement := 'CREATE TABLE ' || v_local_table_name || 
                              ' AS SELECT * FROM ' || v_select_from;
            
            EXECUTE IMMEDIATE v_ddl_statement;
            
            -- –ü–æ–¥—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            EXECUTE IMMEDIATE 'SELECT COUNT(*) FROM ' || v_local_table_name INTO v_target_count;
            
            -- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            IF v_target_count = v_source_count THEN
                v_sync_status := 'SUCCESS';
                
                -- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
                BEGIN
                    EXECUTE IMMEDIATE 'DROP TABLE ' || v_backup_table_name;
                EXCEPTION
                    WHEN OTHERS THEN NULL;
                END;
                
                -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                BEGIN
                    DBMS_STATS.GATHER_TABLE_STATS(USER, v_local_table_name);
                EXCEPTION
                    WHEN OTHERS THEN NULL;
                END;
                
            ELSE
                v_sync_status := 'WARNING';
                v_error_msg := 'Row count mismatch: source=' || v_source_count || ', target=' || v_target_count;
            END IF;
            
        EXCEPTION
            WHEN OTHERS THEN
                v_error_msg := SQLERRM;
                v_sync_status := 'ERROR';
                
                -- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                BEGIN
                    EXECUTE IMMEDIATE 'DROP TABLE ' || v_local_table_name;
                EXCEPTION
                    WHEN OTHERS THEN NULL;
                END;
                
                BEGIN
                    EXECUTE IMMEDIATE 'ALTER TABLE ' || v_backup_table_name || 
                                     ' RENAME TO ' || v_local_table_name;
                    DBMS_OUTPUT.PUT_LINE('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è —Ç–∞–±–ª–∏—Ü—ã');
                EXCEPTION
                    WHEN OTHERS THEN NULL;
                END;
        END;
    END IF;
    
    -- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    v_end_time := SYSTIMESTAMP;
    INSERT INTO sync_log (
        table_name, sync_date, sync_type, status, 
        source_row_count, target_row_count, duration_seconds,
        validation_result, error_msg
    ) VALUES (
        p_table_name, SYSDATE, p_sync_type, v_sync_status,
        v_source_count, v_target_count, 
        EXTRACT(SECOND FROM (v_end_time - v_start_time)),
        v_validation_result, v_error_msg
    );
    COMMIT;
    
    -- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –≤—ã–≤–æ–¥
    DBMS_OUTPUT.PUT_LINE('=== –û–¢–ß–ï–¢ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò –î–õ–Ø ' || p_table_name || ' ===');
    DBMS_OUTPUT.PUT_LINE('–°—Ç–∞—Ç—É—Å: ' || v_sync_status);
    DBMS_OUTPUT.PUT_LINE('–°—Ç—Ä–æ–∫ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ: ' || v_source_count);
    DBMS_OUTPUT.PUT_LINE('–°—Ç—Ä–æ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–ø–∏–∏: ' || v_target_count);
    DBMS_OUTPUT.PUT_LINE('–õ–æ–∫–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞: ' || v_local_table_name);
    DBMS_OUTPUT.PUT_LINE('–í–∞–ª–∏–¥–∞—Ü–∏—è: ' || v_validation_result);
    IF v_error_msg IS NOT NULL THEN
        DBMS_OUTPUT.PUT_LINE('–û—à–∏–±–∫–∞: ' || v_error_msg);
    END IF;
    
END sync_single_table_advanced;
/
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π

–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ `create_smart_sync_job` —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞–Ω–∏—è DBMS_SCHEDULER —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º[3][11]:

```sql
CREATE OR REPLACE PROCEDURE create_smart_sync_job(
    p_table_name VARCHAR2,
    p_schedule_interval VARCHAR2 DEFAULT 'FREQ=DAILY;BYHOUR=20',
    p_dblink_name VARCHAR2,
    p_sync_type VARCHAR2 DEFAULT 'FULL',
    p_min_row_threshold NUMBER DEFAULT 1,
    p_test_run BOOLEAN DEFAULT TRUE
) IS
    v_job_name VARCHAR2(128);
    v_test_result VARCHAR2(4000);
    v_source_count NUMBER;
    v_is_valid BOOLEAN;
    v_base_table_name VARCHAR2(128);
BEGIN
    -- –ò–∑–≤–ª–µ–∫–∞–µ–º –±–∞–∑–æ–≤–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è job_name
    IF INSTR(p_table_name, '.') > 0 THEN
        v_base_table_name := REGEXP_SUBSTR(UPPER(TRIM(p_table_name)), '[^.]+$');
    ELSE
        v_base_table_name := UPPER(TRIM(p_table_name));
    END IF;
    
    v_job_name := 'SYNC_' || v_base_table_name || '_JOB';
    
    -- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
    IF p_test_run THEN
        DBMS_OUTPUT.PUT_LINE('=== –í–´–ü–û–õ–ù–ï–ù–ò–ï –¢–ï–°–¢–û–í–û–ì–û –ó–ê–ü–£–°–ö–ê ===');
        validate_sync_environment(
            p_table_name => p_table_name,
            p_dblink_name => p_dblink_name,
            p_validation_result => v_test_result,
            p_source_count => v_source_count,
            p_is_valid => v_is_valid
        );
        
        DBMS_OUTPUT.PUT_LINE('–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ' || v_test_result);
        
        IF NOT v_is_valid THEN
            RAISE_APPLICATION_ERROR(-20001, '–¢–µ—Å—Ç–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞: ' || v_test_result);
        END IF;
        
        IF v_source_count < p_min_row_threshold THEN
            RAISE_APPLICATION_ERROR(-20002, '–í –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö (' || 
                v_source_count || ' —Å—Ç—Ä–æ–∫, –º–∏–Ω–∏–º—É–º —Ç—Ä–µ–±—É–µ—Ç—Å—è: ' || p_min_row_threshold || ')');
        END IF;
        
        DBMS_OUTPUT.PUT_LINE('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ. –ù–∞–π–¥–µ–Ω–æ —Å—Ç—Ä–æ–∫: ' || v_source_count);
    END IF;
    
    -- –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
    BEGIN
        DBMS_SCHEDULER.DROP_JOB(job_name => v_job_name, force => TRUE);
        DBMS_OUTPUT.PUT_LINE('–£–¥–∞–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ: ' || v_job_name);
    EXCEPTION
        WHEN OTHERS THEN 
            DBMS_OUTPUT.PUT_LINE('–ü—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
    END;
    
    -- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
    DBMS_SCHEDULER.CREATE_JOB(
        job_name        => v_job_name,
        job_type        => 'PLSQL_BLOCK',
        job_action      => 'BEGIN sync_single_table_advanced(''' || p_table_name || ''', ''' || 
                          p_dblink_name || ''', ''' || p_sync_type || ''', ' || 
                          p_min_row_threshold || '); END;',
        start_date      => SYSTIMESTAMP + INTERVAL '5' MINUTE,
        repeat_interval => p_schedule_interval,
        enabled         => TRUE,
        comments        => '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã ' || p_table_name || ' (—Ç–∏–ø: ' || p_sync_type || ')'
    );
    
    DBMS_OUTPUT.PUT_LINE('=== –ó–ê–î–ê–ù–ò–ï –°–û–ó–î–ê–ù–û –£–°–ü–ï–®–ù–û ===');
    DBMS_OUTPUT.PUT_LINE('–ò–º—è –∑–∞–¥–∞–Ω–∏—è: ' || v_job_name);
    DBMS_OUTPUT.PUT_LINE('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: ' || p_schedule_interval);
    DBMS_OUTPUT.PUT_LINE('–¢–∏–ø —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: ' || p_sync_type);
    DBMS_OUTPUT.PUT_LINE('–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Å—Ç—Ä–æ–∫: ' || p_min_row_threshold);
    DBMS_OUTPUT.PUT_LINE('–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫: —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç');
    
END create_smart_sync_job;
/
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏

–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏[12][13]:

```sql
CREATE OR REPLACE PROCEDURE manage_sync_jobs(
    p_action VARCHAR2, -- 'ENABLE', 'DISABLE', 'DROP', 'STATUS'
    p_table_name VARCHAR2 DEFAULT NULL -- NULL = –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è
) IS
    v_job_pattern VARCHAR2(128);
    v_count NUMBER := 0;
BEGIN
    -- –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω –ø–æ–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π
    IF p_table_name IS NOT NULL THEN
        -- –ò–∑–≤–ª–µ–∫–∞–µ–º –±–∞–∑–æ–≤–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã
        IF INSTR(p_table_name, '.') > 0 THEN
            v_job_pattern := 'SYNC_' || REGEXP_SUBSTR(UPPER(TRIM(p_table_name)), '[^.]+$') || '_JOB';
        ELSE
            v_job_pattern := 'SYNC_' || UPPER(TRIM(p_table_name)) || '_JOB';
        END IF;
    END IF;
    
    DBMS_OUTPUT.PUT_LINE('=== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–î–ê–ù–ò–Ø–ú–ò –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò ===');
    DBMS_OUTPUT.PUT_LINE('–î–µ–π—Å—Ç–≤–∏–µ: ' || UPPER(p_action));
    IF p_table_name IS NOT NULL THEN
        DBMS_OUTPUT.PUT_LINE('–¢–∞–±–ª–∏—Ü–∞: ' || p_table_name);
    ELSE
        DBMS_OUTPUT.PUT_LINE('–û–±–ª–∞—Å—Ç—å: –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
    END IF;
    DBMS_OUTPUT.PUT_LINE('');
    
    FOR job_rec IN (
        SELECT job_name, enabled, state
        FROM user_scheduler_jobs 
        WHERE job_name LIKE 'SYNC_%_JOB'
        AND (p_table_name IS NULL OR job_name = v_job_pattern)
        ORDER BY job_name
    ) LOOP
        v_count := v_count + 1;
        
        CASE UPPER(p_action)
            WHEN 'ENABLE' THEN
                BEGIN
                    DBMS_SCHEDULER.ENABLE(job_rec.job_name);
                    DBMS_OUTPUT.PUT_LINE('‚úì –í–∫–ª—é—á–µ–Ω–æ: ' || job_rec.job_name);
                EXCEPTION
                    WHEN OTHERS THEN
                        DBMS_OUTPUT.PUT_LINE('‚úó –û—à–∏–±–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è ' || job_rec.job_name || ': ' || SQLERRM);
                END;
                
            WHEN 'DISABLE' THEN
                BEGIN
                    DBMS_SCHEDULER.DISABLE(job_rec.job_name);
                    DBMS_OUTPUT.PUT_LINE('‚úì –û—Ç–∫–ª—é—á–µ–Ω–æ: ' || job_rec.job_name);
                EXCEPTION
                    WHEN OTHERS THEN
                        DBMS_OUTPUT.PUT_LINE('‚úó –û—à–∏–±–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è ' || job_rec.job_name || ': ' || SQLERRM);
                END;
                
            WHEN 'DROP' THEN
                BEGIN
                    DBMS_SCHEDULER.DROP_JOB(job_rec.job_name, force => TRUE);
                    DBMS_OUTPUT.PUT_LINE('‚úì –£–¥–∞–ª–µ–Ω–æ: ' || job_rec.job_name);
                EXCEPTION
                    WHEN OTHERS THEN
                        DBMS_OUTPUT.PUT_LINE('‚úó –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è ' || job_rec.job_name || ': ' || SQLERRM);
                END;
                
            WHEN 'STATUS' THEN
                DBMS_OUTPUT.PUT_LINE('üìã ' || job_rec.job_name || 
                    ' | –í–∫–ª—é—á–µ–Ω–æ: ' || job_rec.enabled || 
                    ' | –°–æ—Å—Ç–æ—è–Ω–∏–µ: ' || NVL(job_rec.state, 'N/A'));
            ELSE
                DBMS_OUTPUT.PUT_LINE('‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: ' || p_action);
        END CASE;
    END LOOP;
    
    IF v_count = 0 THEN
        DBMS_OUTPUT.PUT_LINE('–ó–∞–¥–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
    ELSE
        DBMS_OUTPUT.PUT_LINE('');
        DBMS_OUTPUT.PUT_LINE('–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–¥–∞–Ω–∏–π: ' || v_count);
    END IF;
    
END manage_sync_jobs;
/
```

## –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏[14]:

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò—Å—Ç–æ—Ä–∏—è –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

**–ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**

```sql
-- –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
SELECT * FROM v_sync_dashboard;

-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
SELECT 
    table_name,
    sync_date,
    status,
    source_row_count,
    target_row_count,
    duration_seconds,
    SUBSTR(error_msg, 1, 100) as error_summary
FROM sync_log 
WHERE sync_date > SYSDATE - 7 
ORDER BY sync_date DESC;

-- –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
SELECT 
    job_name,
    enabled,
    state,
    next_run_date,
    last_start_date
FROM user_scheduler_jobs 
WHERE job_name LIKE 'SYNC_%_JOB'
ORDER BY job_name;
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã:**

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ dblink
SELECT 'DBLINK_OK' as status FROM dual@YOUR_DBLINK;

-- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ dblink
SELECT owner, table_name 
FROM all_tables@YOUR_DBLINK 
WHERE owner = 'YOUR_SCHEMA'
ORDER BY table_name;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π
SELECT 
    job_name,
    status,
    actual_start_date,
    run_duration,
    error#,
    additional_info
FROM user_scheduler_job_run_details
WHERE job_name LIKE 'SYNC_%_JOB'
ORDER BY actual_start_date DESC;
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã

**–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**

```sql
-- –í–∫–ª—é—á–∞–µ–º –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π
SET SERVEROUTPUT ON;

-- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ 20:00
BEGIN
    create_smart_sync_job(
        p_table_name        => 'HR.EMPLOYEES',          -- –ü–æ–ª–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã
        p_schedule_interval => 'FREQ=DAILY;BYHOUR=20',  -- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 20:00
        p_dblink_name       => 'PROD_LINK',             -- –ò–º—è dblink
        p_sync_type         => 'FULL',                  -- –ü–æ–ª–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
        p_min_row_threshold => 1,                       -- –ú–∏–Ω–∏–º—É–º 1 —Å—Ç—Ä–æ–∫–∞
        p_test_run          => TRUE                     -- –° —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    );
END;
/
```

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è**

```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞–Ω–∏—è
BEGIN
    manage_sync_jobs('STATUS', 'HR.EMPLOYEES');
END;
/

-- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
BEGIN
    DBMS_SCHEDULER.RUN_JOB('SYNC_EMPLOYEES_JOB', TRUE);
END;
/
```

### –ú–∞—Å—Å–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
DECLARE
    TYPE t_tables IS TABLE OF VARCHAR2(100);
    v_tables t_tables := t_tables('HR.EMPLOYEES', 'SALES.ORDERS', 'INVENTORY.PRODUCTS');
BEGIN
    FOR i IN 1..v_tables.COUNT LOOP
        create_smart_sync_job(
            p_table_name        => v_tables(i),
            p_schedule_interval => 'FREQ=DAILY;BYHOUR=20',
            p_dblink_name       => 'PROD_LINK',
            p_sync_type         => 'FULL',
            p_min_row_threshold => 1,
            p_test_run          => TRUE
        );
    END LOOP;
END;
/
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

**–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
SELECT 
    table_name,
    health_status,
    sync_date,
    source_row_count,
    target_row_count
FROM v_sync_dashboard
ORDER BY 
    CASE health_status 
        WHEN 'ERROR' THEN 1 
        WHEN 'WARNING' THEN 2 
        ELSE 3 
    END;

-- –û—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
SELECT 
    table_name,
    sync_date,
    error_short
FROM v_sync_dashboard
WHERE health_status IN ('ERROR', 'WARNING')
AND sync_date > SYSDATE - 1;
```

**–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ:**

```sql
-- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
DELETE FROM sync_log 
WHERE sync_date < SYSDATE - 30;
COMMIT;

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–∞–±–ª–∏—Ü
BEGIN
    DBMS_STATS.GATHER_SCHEMA_STATS(USER);
END;
/
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
GRANT CREATE TABLE TO sync_user;
GRANT CREATE PROCEDURE TO sync_user;
GRANT CREATE VIEW TO sync_user;

-- –ü—Ä–∞–≤–∞ –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π
GRANT CREATE JOB TO sync_user;
GRANT MANAGE SCHEDULER TO sync_user;

-- –ü—Ä–∞–≤–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
GRANT ANALYZE ANY TO sync_user;
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è dblink –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–∞**: –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
3. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞:**

```sql
-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
ALTER SYSTEM SET job_queue_processes = 10;

-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
ALTER SESSION SET sort_area_size = 104857600;
ALTER SESSION SET hash_area_size = 104857600;
```

**–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü:**

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö
-- (–≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
CREATE INDEX idx_local_employees_dept 
ON local_employees_backup(department_id);

CREATE INDEX idx_local_orders_date 
ON local_orders_backup(order_date);
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

**1. –û—à–∏–±–∫–∞ ORA-02019: connection description for remote database not found**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω dblink
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ dblink, —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**2. –û—à–∏–±–∫–∞ ORA-27486: insufficient privileges**  
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ CREATE JOB –∏ MANAGE SCHEDULER

**3. –û—à–∏–±–∫–∞ ORA-01918: user does not exist**
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –∏–º–µ–Ω–µ–º —Å—Ö–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –±–µ–∑ —Å—Ö–µ–º—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–ø–∏–π

### –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**

```sql
-- –†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
DECLARE
    v_table_exists NUMBER;
BEGIN
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ backup —Ç–∞–±–ª–∏—Ü—ã
    SELECT COUNT(*) INTO v_table_exists
    FROM user_tables 
    WHERE table_name = 'LOCAL_EMPLOYEES_OLD';
    
    IF v_table_exists > 0 THEN
        -- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ backup
        EXECUTE IMMEDIATE 'DROP TABLE LOCAL_EMPLOYEES_BACKUP';
        EXECUTE IMMEDIATE 'ALTER TABLE LOCAL_EMPLOYEES_OLD RENAME TO LOCAL_EMPLOYEES_BACKUP';
        DBMS_OUTPUT.PUT_LINE('–¢–∞–±–ª–∏—Ü–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏');
    ELSE
        DBMS_OUTPUT.PUT_LINE('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
    END IF;
END;
/
```

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–î–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫:

```sql
-- –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
CREATE OR REPLACE PROCEDURE sync_incremental(
    p_table_name VARCHAR2,
    p_dblink_name VARCHAR2,
    p_timestamp_column VARCHAR2
) IS
    v_last_sync_time TIMESTAMP;
    v_sql VARCHAR2(4000);
BEGIN
    -- –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    SELECT MAX(sync_date) INTO v_last_sync_time
    FROM sync_log 
    WHERE table_name = p_table_name 
    AND status = 'SUCCESS';
    
    -- –§–æ—Ä–º–∏—Ä—É–µ–º SQL –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
    v_sql := 'INSERT INTO LOCAL_' || p_table_name || '_BACKUP 
              SELECT * FROM ' || p_table_name || '@' || p_dblink_name ||
              ' WHERE ' || p_timestamp_column || ' > :last_sync';
              
    EXECUTE IMMEDIATE v_sql USING v_last_sync_time;
    
    DBMS_OUTPUT.PUT_LINE('–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
END;
/
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π:

```sql
CREATE OR REPLACE VIEW v_active_sync_jobs AS
SELECT 
    srj.job_name,
    srj.session_id,
    srj.running_instance,
    srj.elapsed_time,
    srj.cpu_used,
    s.sql_text
FROM user_scheduler_running_jobs srj
LEFT JOIN v$session s ON s.serial# = srj.session_id
WHERE srj.job_name LIKE 'SYNC_%_JOB';
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Oracle APEX

### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ APEX

**1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º:**

```sql
-- SQL –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
SELECT 
    table_name as "–¢–∞–±–ª–∏—Ü–∞",
    CASE health_status
        WHEN 'HEALTHY' THEN '<span class="t-Icon t-Icon--success fa fa-check-circle"></span> –ò—Å–ø—Ä–∞–≤–Ω–æ'
        WHEN 'ERROR' THEN '<span class="t-Icon t-Icon--danger fa fa-exclamation-circle"></span> –û—à–∏–±–∫–∞'  
        WHEN 'WARNING' THEN '<span class="t-Icon t-Icon--warning fa fa-warning"></span> –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ'
        ELSE health_status
    END as "–°—Ç–∞—Ç—É—Å",
    sync_date as "–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è",
    source_row_count as "–°—Ç—Ä–æ–∫ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ",
    target_row_count as "–°—Ç—Ä–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ",
    duration_sec as "–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–µ–∫)",
    error_short as "–û—à–∏–±–∫–∞"
FROM v_sync_dashboard
ORDER BY 
    CASE health_status 
        WHEN 'ERROR' THEN 1 
        WHEN 'WARNING' THEN 2 
        ELSE 3 
    END;
```

**2. –ü—Ä–æ—Ü–µ—Å—Å –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**

```sql
-- PL/SQL –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"
DECLARE
    v_table_name VARCHAR2(128) := :P1_TABLE_NAME;
BEGIN
    sync_single_table_advanced(
        p_table_name => v_table_name,
        p_dblink_name => 'PROD_LINK',
        p_sync_type => 'FULL'
    );
    
    apex_application.g_print_success_message := '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã ' || v_table_name || ' –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
EXCEPTION
    WHEN OTHERS THEN
        apex_application.g_print_error_message := '–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: ' || SQLERRM;
END;
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é —Å–∏—Å—Ç–µ–º—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —É–¥–∞–ª–µ–Ω–Ω—ã–º–∏ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ä–µ–¥–µ Oracle APEX 23.1[6]. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- **–ö–æ–º–ø–ª–µ–∫—Å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –æ–∫—Ä—É–∂–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–ø–∏–π** —Ç–∞–±–ª–∏—Ü —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–ì–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DBMS_SCHEDULER[15]
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ú–µ—Ö–∞–Ω–∏–∑–º—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è** –ø—Ä–∏ —Å–±–æ—è—Ö
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Oracle APEX** –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–î–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏, —Ç–∞–∫ –∏ –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å —Å–æ—Ç–Ω—è–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –°–∏—Å—Ç–µ–º–∞ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞[16][17].

–¶–∏—Ç–∞—Ç—ã:
[1] 17.7 Accessing Data with Database Links - APEX - Oracle Help Center https://docs.oracle.com/en/database/oracle/apex/23.1/htmdb/accessing-data-with-database-links.html
[2] [PDF] Oracle¬Æ APEX - SQL Workshop Guide https://docs.oracle.com/en/database/oracle/apex/23.1/aeutl/oracle-apex-sql-workshop-guide.pdf
[3] Scheduling Jobs with DBMS_SCHEDULER - DBA Genesis Docs https://support.dbagenesis.com/oracle-database/scheduling-jobs-with-dbms_scheduler
[4] Scheduling Jobs with Oracle Scheduler - Oracle Help Center https://docs.oracle.com/en/database/oracle/oracle-database/18/admin/scheduling-jobs-with-oracle-scheduler.html
[5] [PDF] Oracle¬Æ APEX - Installation Guide https://docs.oracle.com/en/database/oracle/apex/23.1/htmig/oracle-apex-installation-guide.pdf
[6] Oracle APEX Release 23.1 https://docs.oracle.com/en/database/oracle/apex/23.1
[7] DBMS_SCHEDULER Jobs https://docs.oracle.com/database/apex-18.1/AEADM/dbms_scheduler-jobs.htm
[8] How to create a DB link between two oracle instances - Stack Overflow https://stackoverflow.com/questions/13267218/how-to-create-a-db-link-between-two-oracle-instances
[9] How to Document Stored Procedures and Functions in Database https://dataedo.com/blog/how-to-document-stored-procedures-and-functions-in-database
[10] Oracle 12c - PL/SQL Tables Replication Between Databases - Scribd https://fr.scribd.com/document/478182379/OracleReplication
[11] DBMS_SCHEDULER - Bright DBA https://www.br8dba.com/dbms_scheduler/
[12] Monitoring Jobs https://docs.oracle.com/cd/E18283_01/server.112/e17120/scheduse008.htm
[13] Monitoring and Managing the Scheduler https://www.devdoc.net/database/OracleDoc_11gR2/server.112/e25494/schedadmin002.htm
[14] Mastering Database Health with 4i's Oracle APEX-Powered Solution https://www.4iapps.com/mastering-database-health-with-4is-oracle-apex-powered-solution/
[15] DBMS_SCHEDULER - Oracle Help Center https://docs.oracle.com/database/121/ARPLS/d_sched.htm
[16] PL/SQL Best Practices - Implementation Guide https://docs.oracle.com/en/industries/retail/retail-analytics-planning/24.1.201.0/rapig/pl-sql-best-practice.htm
[17] Oracle PL/SQL Best Practices - LinkedIn https://www.linkedin.com/pulse/oracle-plsql-best-practices-randall-fadler-v0g8c
[18] selected_image_6026985047775450996.jpg https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/images/72242679/11aad4cd-6f88-4d80-bf77-4720c859b46c/selected_image_6026985047775450996.jpg?AWSAccessKeyId=ASIA2F3EMEYE5FANEI72&Signature=udYLWtUtuJleScg%2BRkLPceuc%2Fa4%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEHAaCXVzLWVhc3QtMSJHMEUCIQCUY5gwPtpVjnovlIeUJhH3YlmTmI%2BQfXcJsv8YrkZ5sgIgVVm93vMWgYJjssvIrAF3V3yZNp3MDFTepO5WZWKcmpIq%2BgQImf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgw2OTk3NTMzMDk3MDUiDIC6y3dd5gu1bVHDhirOBDObDlgLKvqPtAA5TO7JP1Sym4nkXFvCkMH%2FDu%2BO9OnM%2FXxG2DXG%2FI81hSpGusrOqTjZ5PmwH5AAZ5AkNYKbYD%2BePCYbuov3%2FWnivAieza9u1h7S1RnLYk4ES8ufjTHmBA9%2Bb1F9L%2BddSU5SQ3NSifBNTcNk3BYbLinC0dpWBYpJgp74C6Ei%2Bjqb9VeX9xmYz2vSC%2BnqYE1kowYzxFH78MkUhK1clN4kga6sLhgbNg2veDFJwgbr3DQi6emCsX6uMG5lp5JeTWkudGnYDICu0O6Dzd9iXGU%2BWtBNaGMUapb0%2FZv%2FVQ5AVppZulfygDFegqZlpUpykg55gXhlUxDYVr%2FAFsbR%2FSQww8JoFppuw7rOdTB4zdliPXx%2F6H5%2ByiVZTn2BwEiqy7l2IgaKLg7wJPZM1h7XNOb6Jcro0QhY457JhzyFlpw%2BhpxrazzpzpytJe4E2A%2BbcIT4Pz5kzPM22jTtfv7OvoIh6CvQ2BzvDGtygvO17%2BuSgdrzWkk%2FfIi1zIgZjNWc6Fd6P31a8dDa9Ux5eu%2BfIWhYVjc5hhaxG5HOjcI8RoMAPXoANCqC1oa8xEP7vru%2BlBhV%2BKrZYVVDc2SoGyTh0A9HMN9LIIiYiBB8e8JfFFDzmtwtb4zpM4CXivObcJvDScqz7mWzQQd0VU6WY4svaluCkFyArog5ohE6wt6pzxRGcpXTaRa9hwGLOlnx3v6uISWXyf4Bi0L7BZDVBbmoeZA1ig7W11w7aLUnjwPQfvyEns8i8u5zcJJ5deErXD8Q0gpkFFAuMc0MMKWdoMQGOpoBJ6LKKfWF9n%2BMluuhnDEQMcrgpkLZ9aQeevsFrLVZzFfMskzzcCqpjwYWn85RvCOrd1HmSCG9v4d9wuDA9TtaKboTqNU8QS0kkKw%2FI9YUl%2BGIZIWDKnCizCIoFrn%2FlJFTeORwbQqXOryim%2FmG5FAvjdrWigsKj%2Fazu3rWdfywLs%2BjkaCqya78k%2F5pZWrSGvRbKcrOkEU6K9peDA%3D%3D&Expires=1753748001
[19] Oracle APEX: Dynamic REST Source Sync Parameters https://blog.cloudnueva.com/dynamic-parameters-in-oracle-apex-rest-data-source-synchronizations
[20] Oracle DBMS_SCHEDULER and PostgreSQL scheduled Lambda https://docs.aws.amazon.com/dms/latest/oracle-to-aurora-postgresql-migration-playbook/chap-oracle-aurora-pg.special.scheduler.html
[21] 2.16 Managing Database Links https://docs.oracle.com/database/apex-5.1/AEUTL/managing-db-links.htm
[22] Synchronizing Data from REST Services to Local Table - YouTube https://www.youtube.com/watch?v=9ZZBXI6y0QU
[23] 18.4.10 Managing Data Synchronization - App Builder User's Guide https://docs.oracle.com/en/database/oracle/apex/24.2/htmdb/managing-data-synchronization.html
[24] Comments Style - PL/SQL & SQL Coding Guidelines https://insum-labs.github.io/plsql-and-sql-coding-guidelines/v1.1/3-coding-style/02-coding-style-comments/
[25] REST Synchronization in Oracle APEX | Sync Remote and Local ... https://www.youtube.com/watch?v=m-2Rn_4OS8k
[26] DBMS_SCHEDULER - Oracle Help Center https://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_sched.htm
[27] [PDF] Oracle PLSQL Coding Guidelines 1. Overview 2. Standards https://www.topcoder.com/i/development/uml/Oracle_PLSQL_Coding_Guidelines.pdf
[28] 17.4.7 Managing Data Synchronization - APEX - Oracle Help Center https://docs.oracle.com/en/database/oracle/apex/22.2/htmdb/managing-data-synchronization.html
[29] A.1 List of DBMS_SCHEDULER Jobs https://docs.oracle.com/cd/E59726_01/doc.50/e39151/dbms_jobs001.htm
[30] Style Guide - Oracle SQL and PL/SQL Optimization for Developers https://oracle.readthedocs.io/en/latest/sql/basics/style-guide.html
[31] Oracle APEX Limitations on Autonomous Database https://docs.public.content.oci.oraclecloud.com/en-us/iaas/autonomous-database-serverless/doc/apex-notes-autonomous.html
[32] 157 dbms_scheduler - PL/SQL Packages and Types Reference https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_SCHEDULER.html
[33] Database Links (Oracle) | SAP Help Portal https://help.sap.com/docs/EAD_CLOUD/c50a2057f35a4731838910588f247f4a/c7ce10036e1b10148d45a5a097d921f9.html
[34] 6. Executing PL/SQL - node-oracledb's documentation https://node-oracledb.readthedocs.io/en/latest/user_guide/plsql_execution.html
[35] How to Create a DBLink in Oracle - Process Street https://www.process.st/how-to/creating-a-dblink-in-oracle/
[36] How to Back Up Oracle APEX Applications (2025 Guide) - Revion https://revion.com/how-to-back-up-oracle-apex-applications-2025-guide/
[37] 6. Executing PL/SQL - python-oracledb's documentation https://python-oracledb.readthedocs.io/en/latest/user_guide/plsql_execution.html
[38] DB-Links, JOINS - Technical Documentation For IFS Cloud https://docs.ifs.com/techdocs/21r2/045_administration_aurena/260_data_management/050_data_migration/070_references/020_tips_and_tricks/tipsandtricksjoinstolus/
[39] 2.3. Creating and Maintaining Database Links | Administration Guide https://docs.redhat.com/en/documentation/red_hat_directory_server/11/html/administration_guide/configuring_directory_databases-creating_and_maintaining_database_links
[40] Backup and Recovery User's Guide - Database - Oracle Help Center https://docs.oracle.com/en/database/oracle/oracle-database/23/bradv/book-index.html
[41] PLSQL Stored Procedure Examples | PDF | Pl/Sql - Scribd https://www.scribd.com/document/15841882/PLSQL-Stored-Procedure-Examples
[42] The New Create Database Link Table Form - Data Masker for Oracle 5 https://documentation.red-gate.com/dmo/data-masker-for-oracle-help/major-data-masker-application-components/the-new-create-database-link-table-form
[43] PL/SQL Procedures and Functions - Oracle Help Center https://docs.oracle.com/en/database/other-databases/timesten/22.1/plsql-developer/pl-sql-procedures-and-functions.html
[44] CREATE PUBLIC DATABASE LINK v17 - EDB https://www.enterprisedb.com/docs/epas/latest/reference/oracle_compatibility_reference/epas_compat_sql/21_create_public_database_link/
[45] Index - Oracle Help Center https://docs.oracle.com/en/database/oracle/apex/23.1/htmdb/book-index.html
[46] Sample PL/SQL Programs https://docs.oracle.com/cd/B10500_01/appdev.920/a96624/a_samps.htm
[47] What's New in Oracle APEX 23.1 https://apex.oracle.com/en/platform/features/whats-new-231/
[48] Create DB Link To From Apex To Another Oracle Database - –ë–∞–∑–∞ ... https://www.apexhostingservices.com/clients/index.php?rp=%2Fknowledgebase%2F20%2FCreate-DB-Link-To-From-Apex-To-Another-Oracle-Database.html&language=ukranian
[49] Sync Framework Tutorial - Documentation - Devart https://docs.devart.com/dotconnect/oracle/SyncFramework.html
[50] 3 Synchronization - Oracle Help Center https://docs.oracle.com/cd/B19188_01/doc/B15920/sync.htm
[51] 26.1 Available Parameter Values - API Reference https://docs.oracle.com/en/database/oracle/apex/23.1/aeapi/Available-Parameter-Values.html
[52] 4 Replicating Data Using Oracle Streams http://www.asktheway.org/official-documents/oracle/E11882_01/server.112/e17516/tdpii_repcont.htm
[53] Monitoring and Mana ging the Scheduler - filibeto.org https://www.filibeto.org/sun/lib/nonsun/oracle/11.1.0.6.0/B28359_01/server.111/b28310/schedadmin002.htm
[54] Oracle Application Express for Amazon RDS for Oracle demystified https://aws.amazon.com/blogs/database/oracle-application-express-for-amazon-rds-for-oracle-demystified/
[55] 2 Synchronization - Oracle Help Center https://docs.oracle.com/cd/E12095_01/doc.10303/e12090/sync.htm
[56] DBMS_SCHEDULER in Oracle Database - Complete Guide https://dev.to/mrcaption49/dbmsscheduler-complete-guide-2025-4lf1
[57] Index - APEX - Oracle Help Center https://docs.oracle.com/en/database/oracle/apex/23.1/aeadm/book-index.html
[58] Synchronisation of PL/SQL procedure. How to guaranty execution of ... https://stackoverflow.com/questions/17321687/synchronisation-of-pl-sql-procedure-how-to-guaranty-execution-of-procedure-only
[59] Creating, Running, and Managing Jobs http://suporte.universalrh.com.br/oradoc/server.112/e25494/scheduse002.htm
[60] Administration Guide - Oracle Help Center https://docs.oracle.com/en/database/oracle/apex/23.1/aeadm/toc.htm
[61] plsql - How to synchronize threads in Oracle? - Stack Overflow https://stackoverflow.com/questions/63114257/how-to-synchronize-threads-in-oracle
[62] oracle synchronize 2 tables - Stack Overflow https://stackoverflow.com/questions/45034788/oracle-synchronize-2-tables
[63] Documentation - Oracle APEX https://apex.oracle.com/en/learn/documentation/
[64] PL/SQL Packages - GeeksforGeeks https://www.geeksforgeeks.org/plsql/plsql-packages/
[65] Synchronization Oracle RDB - WinCC OA Portal https://www.winccoa.com/documentation/WinCCOA/3.18/en_US/HDB_RDB_Parallel/HDB_RDB_Parallel-05.html
[66] Creating stored procedures in a PL/SQL package - IBM https://www.ibm.com/docs/en/data-studio/4.1.1?topic=procedures-creating-stored-in-plsql-package
[67] Historical Synchronization - WinCC OA Portal https://www.winccoa.com/documentation/WinCCOA/3.19/en_US/RDB/RDB-25.html
[68] Oracle APEX new features ‚Äì the low-code platform keeps evolving https://pretius.com/blog/oracle-apex-new-features
[69] 9 Using PL/SQL Packages - filibeto.org https://www.filibeto.org/sun/lib/nonsun/oracle/10.2.0.1.0/B19306_01/appdev.102/b14261/packages.htm
[70] Synchronize data from a self-managed Oracle database to an ... https://www.alibabacloud.com/help/id/dts/user-guide/synchronize-data-from-a-self-managed-oracle-database-to-an-analyticdb-for-postgresql-instance
[71] Oracle SQLcl 23.1 Enhanced APEX functionality https://mattmulvaney.hashnode.dev/oracle-sqlcl-231-enhanced-apex-functionality
[72] Sample PLSQL Packages | PDF - Scribd https://www.scribd.com/doc/270556480/Sample-Plsql-Packages
[73] Synchronize data from a self-managed Oracle database to a ... https://www.alibabacloud.com/help/en/dts/user-guide/synchronize-data-from-a-self-managed-oracle-database-to-a-datahub-project-1
[74] Oracle APEX Release 23.1 - Develop Apps https://docs.oracle.com/en/database/oracle/apex/23.1/buildapplications.html
[75] 10 PL/SQL Packages https://docs.oracle.com/cd/E11882_01/appdev.112/e25519/packages.htm
[76] Oracle Apex 23.1 - a deep dive into the biggest new features https://www.youtube.com/watch?v=Hi4KVHYdPBU
[77] Sample Variable for PL/SQL Procedure Source Type https://docs.oracle.com/cd/E18727-01/doc.121/e13459/T256665T498436.htm
[78] How to sync tables and views between two oracle database ? : r/SQL https://www.reddit.com/r/SQL/comments/xnlh05/how_to_sync_tables_and_views_between_two_oracle/
